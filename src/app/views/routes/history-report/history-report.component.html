<div class="layout-content">

    <p-panel header="SERVICE HISTORY REPORT [ {{title}} ]" [style]="{ minHeight: '360px' }">
        <div class="grid p-fluid mt-2">
            <div class="col-12 md:col-3">
                <div class="flex flex-column gap-2">
                    <label for="tbSearchStaffName">
                        Staff Name
                    </label>
                    <p-dropdown placeholder="Select Staff" [options]="staffList" [(ngModel)]="empName" [style]="{'width': '100%'}" [showClear]="true"
                        [filter]="true"></p-dropdown>
                </div>
            </div>
                        <div class="col-12 md:col-3">
                <div class="flex flex-column gap-2">
                    <label for="username"> Select Date From</label>
                    <p-calendar [showIcon]="true" [(ngModel)]='fromdate'   dateFormat="dd-M-yy" readonly required
                        [style]="{'width': '100%'}" />
                </div>
            </div>
            <div class="col-12 md:col-3">
                <div class="flex flex-column gap-2">
                    <label for="username"> End Date</label>
                    <p-calendar [showIcon]="true" [(ngModel)]='enddate'  dateFormat="dd-M-yy" readonly required
                        [style]="{'width': '100%'}" />
                </div>
            </div>
            <div class="col-12 md:col-3">
                <div class="flex flex-column gap-2">
                    <label for="currency-japan">
                        Select Company
                    </label>
                    <p-dropdown placeholder="Select Company"  [options]="companies" [(ngModel)]="filtercompany" [showClear]="true"></p-dropdown>
                </div>
            </div>
                 <div class="col-12 md:col-3">
                <div class="flex flex-column gap-2">
                    <label for="currency-japan">
                        Select Action
                    </label>
                    <p-dropdown placeholder="Select Action"  [options]="Action" [(ngModel)]="serviceReqStatus" [showClear]="true"></p-dropdown>
                </div>
            </div>
            <div class="col-12 md:col-2">
                <div class="flex flex-column gap-2" style="margin-top: 12px;">
                    <label class="mb-2" for="currency-japan">
                    </label>
                    <button pButton type="submit" (click)="filterData()" label="Filter"
                        class="p-button-success vertical-align-bottom"></button>

                </div>
            </div>
                 <div class="col-12 md:col-2">
                <div class="flex flex-column gap-2" style="margin-top: 12px;">
                    <label class="mb-2" for="currency-japan">
                    </label>
                    <p-splitButton label="Refresh" (click)="ReloadData()" icon="pi pi-refresh"  
                        class="p-button-secondary"></p-splitButton>

                </div>
            </div>
                        <div class="col-12 md:col-2">
                <div class="flex flex-column gap-2" style="margin-top: 12px;">
                    <label class="mb-2" for="Excel">
                    </label>  
                   <p-button label="Excel" icon="pi pi-file-excel" (click)="exportToExcel()"
                    [style]="{ 'background-color': '#28a745', 'border-color': '#28a745' }"/>
                </div>
            </div>
        </div>
        <p-panel header="REPORT DETAIL" [style]="{ minHeight: '360px' }">

            <div class="grid">
                <div class="col-12">
                    <p-table [paginator]="true" [value]="ServiceDatas" [rows]="10" [showCurrentPageReport]="true"
                        currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
                        styleClass="p-datatable-striped">
                        <ng-template pTemplate="header">
                            <tr>
                                <th>Staff Code</th>
                                <th>Staff Name</th>
                                <th>Company Name </th>
                                <th>Type</th>
                                <th>Reason</th>
                                <th>Requested Date</th>
                                <th>Action</th>
                            </tr>
                        </ng-template>

                        <ng-template pTemplate="body" let-item>
                            <tr style="cursor:pointer">
                                <td>{{item.serviceReqId}}</td>
                                <td>{{item.hruser}}</td>
                                <td>{{item.companyName}}</td>
                                <td>{{item.serviceReqTypeNavigation.serviceReqTypeName}}</td>
                                <td>{{item.serviceReqReason}}</td>
                                <td>{{item.serviceReqDate | date:"dd/MMM/yyyy"}}</td>
                         <td style="width:8rem">

                            <ng-container *ngIf="item.serviceReqStatus === 2">
                                <span
                                    style='padding: 5px;font-weight: bolder;  color: rgb(202, 10, 106);'>Approved</span>
                            </ng-container>

                            <ng-container *ngIf="item.serviceReqStatus === 3">
                                <span
                                    style='padding: 5px;font-weight: bolder; font-size: larger; color: rgb(13, 164, 202);'>Rejected</span>

                            </ng-container>
                        </td>
                            </tr>
                        </ng-template>
                    </p-table>
                </div>
            </div>

        </p-panel>
    </p-panel>
</div>
<p-toast></p-toast>